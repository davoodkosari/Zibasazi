@using Radyn.Congress.Tools
@using Radyn.Web.Mvc;
@using Radyn.WebApp

@model IEnumerable<Radyn.Congress.DataStructure.WorkShopUser>
    <script type="text/javascript">
        function PaymentDetails(id) {
            if (id != "")
                ShowModal("@Url.Content("~/Payment/Transaction/LookUPTransactionDetails?Id=")" + id);
            else
                alert('@Resources.Common.No_results_found');

        }
        function Details(userId, workshopId) {
            if (userId != "" && workshopId != "") {
                ShowModal("@Url.Content("~/FormGenerator/UI/LookUpFormData?refId=")" + userId + "," + workshopId + "&objectname=WorkShopUser");
            }

        }
       
        function DeleteReserv(userId, workshopId) {
            if (confirm('@Resources.Common.Are_You_Soure_For_Delete')) {
                $.get("@Url.Content("~/Congress/ManagmentPanel/DeleteUserWorkShop")", { userId: userId, workshopId: workshopId, date: new Date().getTime() }, function (data) {
                    if (data != "false") {
                        SearchWorkShop();
                    }
                });
            }

        }
    </script>
    <div class="fit">


        @{
            Html.Radyn().Grid(Model).DataKeys(x => x.Add(y => y.WorkShopId)).DataKeys(y => y.Add(x => x.UserId)).Name("Grid").HtmlAttributes(new { style = "width:98%;margin: 0 auto" }).Columns(columns =>
            {


                columns.Template(workShopUser => workShopUser.User.FullName).Title(@Resources.Congress.User).Width(300).HeaderHtmlAttributes(new { style = "text-align:center" });
                columns.Template(workShopUser => workShopUser.RegisterDate).Title(@Resources.Congress.RegisterDate).Width(150).HeaderHtmlAttributes(new { style = "text-align:center" });
                columns.Template(workShopUser => Html.DropDownList("Status-" + workShopUser.UserId, new SelectList(ViewBag.status, "Key", "Value", workShopUser.Status), new { @class = "list-group-grid" }) + " <input type=\"hidden\" value=\"" + workShopUser.UserId + "\" name=\"ModelId\" Id=\"ModelId\"  />" + "<input type=\"hidden\" name=\"oldstatus-" + workShopUser.UserId + "\" id=\"oldtype-" + workShopUser.UserId + "\" value=\"" + workShopUser.Status + "\" />").Title(Resources.Congress.RezervStatus).Encode(false).HeaderHtmlAttributes(new { style = "text-align:center;width:50" }).Width(150);
                columns.Template(workShopUser => ((workShopUser.Status != (byte)Enums.WorkShopRezervState.Finalconfirm && workShopUser.Status != (byte)Enums.WorkShopRezervState.PresentConfirm) ? " <img alt='" + @Resources.Common.Delete + "' style='cursor: pointer' width = '20px;' height = '20px;' src='" + Url.Content("~/Content/Images/Delete-Close.png") + "'    onclick=\"DeleteReserv('" + workShopUser.UserId + "','" + workShopUser.WorkShopId + "');\" />" : "") +
                " <img alt='" + @Resources.Payment.PaymentDetails + "' style='cursor: pointer' width = '20px;' height = '20px;' src='" + Url.Content("/Content/Images/payment-detail.png") + "'    onclick=\"PaymentDetails(" + "'" + workShopUser.TransactionId + "'" + ");\" />" + 
                " <img alt='" + @Resources.Payment.PaymentDetails + "' style='cursor: pointer' width = '20px;' height = '20px;' src='" + Url.Content("~/Content/Images/details.png") + "'    onclick=\"Details('" + workShopUser.UserId + "','" + workShopUser.WorkShopId + "');\" />" +
                    "<a style='cursor: pointer;' onclick=\"ModifyWorkShopUser('" + workShopUser.UserId+ "','"+PageMode.Edit+"')\" > " +
                                                 " <img width='20' align='absmiddle' title='" + Resources.Common.Edit + "' src='" + Url.Content("~/Content/Images/edit.png") + "' />" + "</a>"
                                                 
                                                 ).Title(Resources.Common.Delete).Width(80).Encode(false).HeaderHtmlAttributes(new { style = "text-align:center" });

            })


        .Sortable(sorting => sorting.Enabled(true))
        .Pageable(paging => paging.Enabled(true))
        .Filterable(filtering => filtering.Enabled(true))
        .Footer(false).Render();
        }

    </div>






