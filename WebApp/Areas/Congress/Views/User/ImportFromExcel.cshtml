@using Radyn.Utility
@using Radyn.Web.Mvc;
@using Radyn.WebApp.AppCode.Security

@model Radyn.Congress.DataStructure.User
@{
    ViewBag.Title = Resources.Congress.ImportFromExcel;
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section Head{
    <script type="text/javascript">

        function onComplete(e) {
            ShowPostBackLoader();

            $("#DivResult").html("");
            $.get("@Url.Content("~/Congress/User/GetImportData")", { date: new Date().getTime() }, function (data) {
                if (data != "false") {
                    $("#DivResult").html(data).hide();
                    $("#DivResult").slideDown();

                }
                ShowRadynMessage();
            });
        }
        function onRemove(e) {
            $("#DivResult").html("");
        }


    </script>
}

@section PageAction
{
    <div class="button-div m-btn waves-green i-save">
        @{Html.Radyn().ImageActionLink().Text(@Resources.Common.Save).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("~/Content/Images/Save.png")).ImagePosition(ImageActionLink.Position.Right).ImageWidth("15").ImageHeight("20").Submit().Render(); }
    </div>
    <div class="button-div m-btn waves-blue i-download">
        @{Html.Radyn().ImageActionLink().NavigateUrl(Url.Content(SessionParameters.Culture == "fa-IR" ? "/Areas/Congress/Content/Files/UserListFA.xls" : "/Areas/Congress/Content/Files/UserListFA.xls")).Text(Resources.Congress.SampleFile).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("/Areas/Congress/Content/Images/go-bottom.png")).ImagePosition(ImageActionLink.Position.Right).Render();}
    </div>
    <div class="button-div m-btn waves-green i-send">
        @{Html.Radyn().ImageActionLink().Text(Resources.Congress.Send).Align(Resources.Design.Align.ToEnum<ImageActionLink.Alignment>()).ImageUrl(Url.Content("~/Content/Images/Save.png")).ImagePosition(Resources.Design.Align.ToEnum<ImageActionLink.Position>()).OtherAttribute(new { onclick = "onComplete();" }).Render(); }
    </div>
    <div class="button-div m-btn waves-red i-return">
        @{Html.Radyn().ImageActionLink().NavigateUrl(Url.Content("~/Congress/User/Index")).Text(Resources.Common.Return).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("~/Content/Images/go-back.png")).ImagePosition(ImageActionLink.Position.Right).Render();}


    </div>
}
@section PageActionDown
{
    <div class="button-div m-btn waves-green i-save">
        @{Html.Radyn().ImageActionLink().Text(@Resources.Common.Save).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("~/Content/Images/Save.png")).ImagePosition(ImageActionLink.Position.Right).ImageWidth("15").ImageHeight("20").Submit().Render(); }
    </div>
    <div class="button-div m-btn waves-blue i-download">
        @{Html.Radyn().ImageActionLink().NavigateUrl(Url.Content(SessionParameters.Culture == "fa-IR" ? "/Areas/Congress/Content/Files/UserListFA.xls" : "/Areas/Congress/Content/Files/UserListFA.xls")).Text(Resources.Congress.SampleFile).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("/Areas/Congress/Content/Images/go-bottom.png")).ImagePosition(ImageActionLink.Position.Right).Render();}
    </div>
    <div class="button-div m-btn waves-green i-send">
        @{Html.Radyn().ImageActionLink().Text(Resources.Congress.Send).Align(Resources.Design.Align.ToEnum<ImageActionLink.Alignment>()).ImageUrl(Url.Content("~/Content/Images/Save.png")).ImagePosition(Resources.Design.Align.ToEnum<ImageActionLink.Position>()).OtherAttribute(new { onclick = "onComplete();" }).Render(); }
    </div>
    <div class="button-div m-btn waves-red i-return">
        @{Html.Radyn().ImageActionLink().NavigateUrl(Url.Content("~/Congress/User/Index")).Text(Resources.Common.Return).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("~/Content/Images/go-back.png")).ImagePosition(ImageActionLink.Position.Right).Render();}
    </div>
}
<div id="divContentFile">
    <div class="item-input file-upload">
        <div class="table-row-cap">
            <div class="item">
                @Resources.Congress.File
            </div>
        </div>
        <div class="table-row-item drp ">
            <div class="item">
                @{
                    Html.RenderAction("FileUploader", "FileUpload", new { area = "FileManager", fileName = "Image" });

                }
            </div>
        </div>
    </div>
</div>

<div id="DivResult"></div>
