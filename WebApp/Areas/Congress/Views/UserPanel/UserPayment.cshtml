@using Radyn.Congress.Tools
@using Radyn.Utility
@using Radyn.Web.Mvc
@using Radyn.WebApp.AppCode.Security
@using Radyn.WebApp.Areas.Congress.Tools
@using Radyn.WebApp.Areas.EnterpriseNode.ExtentionTools
@model Radyn.Congress.DataStructure.User
@{
    ViewBag.Title = Resources.Congress.UserRegisterPayment + " " + (SessionParameters.CongressUser != null ? SessionParameters.CongressUser.EnterpriseNode.EnterpriseNodeTitle() : "");
    Layout = "~/Areas/Congress/Views/Shared/CongressUserLayout.cshtml";
}
@section Head
{
    <script type="text/javascript">
    function GenerateDiscount() {
        $("#DivDiscount").html("");
        $.get("@Url.Content("~/Payment/DiscountType/GenerateDiscount")", { model: '@AppExtention.CongressMoudelName', section: '@((byte) Enums.PaymentSection.UserRegister)', date: new Date().getTime() }, function (data) {
            if (data != "false") {
                $("#DivDiscount").html(data).slideDown("");;
            }

        });

    }

    function ShowHall() {
        var hallId = $("#HallId").val();
        var paymentTypeId = $("#PaymentTypeId").val();
        var selectedChairId = $("#SelectedChairId").val();
        if (hallId != "")
            ShowModalWithReturnValue("/Reservation/HallChairDesign/LookUpView?hallId=" + hallId + "&onlyselectChairTypeId=" + paymentTypeId + "&selectedId=" + selectedChairId + "&maxselect=" + '@StringUtils.Encrypt("1")', "SelectedChairId", "SelectedChairId");
    }

    function ChangeType() {
        var id = $("#PaymentTypeId").val();
        $("#DivRegisterType").html("");
        if (id != "") {
            $.get("@Url.Content("~/Congress/UserRegisterPaymentType/GetRegiterTypeInfo")", { Id: id, date: new Date().getTime() }, function(data) {
                    if (data != "false") {
                        $("#DivRegisterType").html(data).slideDown("slow");;
                    }

                });
            }

        }
        function ShowHallImage(Id) {
            ShowModal('@Url.Content("~/Congress/Configuration/ShowImage?Id=")' + Id);
        }
        $(document).ready(function() {
            ChangeType();
//            GenerateDiscount();
        });
    </script>
}
@section PageTitle
{
    @Resources.Congress.UserRegisterPayment
}
@section PageAction
{
    <div class="button-div m-btn waves-green i-continue">
        @{Html.Radyn().ImageActionLink().Text(Resources.Payment.Continue).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("/Areas/Congress/Content/Images/pay.png")).ImagePosition(ImageActionLink.Position.Right).Class("link-button").Submit().Render(); }
    </div>
    <div class="button-div  m-btn waves-red i-return">
        @{Html.Radyn().ImageActionLink().NavigateUrl(Url.Content("~/Congress/UserPanel/Home")).Text(Resources.Common.Return).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("~/Content/Images/go-back.png")).ImagePosition(ImageActionLink.Position.Right).Render();}

    </div>
}
@section PageActionDown
{
    <div class="button-div m-btn waves-green i-continue">
        @{Html.Radyn().ImageActionLink().Text(Resources.Payment.Continue).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("/Areas/Congress/Content/Images/pay.png")).ImagePosition(ImageActionLink.Position.Right).Submit().Render(); }
    </div>
    <div class="button-div  m-btn waves-red i-return">
        @{Html.Radyn().ImageActionLink().NavigateUrl(Url.Content("~/Congress/UserPanel/Home")).Text(Resources.Common.Return).Align(ImageActionLink.Alignment.Left).ImageUrl(Url.Content("~/Content/Images/go-back.png")).ImagePosition(ImageActionLink.Position.Right).Render();}

    </div>
}
@Html.ValidationSummary(true)
    <div class="radynForm users-page full-size">
        <input type="hidden" name="SelectedChairId" id="SelectedChairId" />
        <div class="item-input">
            <div class="table-row-cap">
                <div class="item">
                    @Resources.Congress.ParticipationType
                </div>
            </div>
            <div class="table-row-item">
                <div class="item">
                    @Html.DropDownListFor(x => x.PaymentTypeId, (SelectList)ViewBag.paymentTypes, new { onchange = "ChangeType()" })
                </div>
            </div>
        </div>
        <div id="DivRegisterType" class="fit"></div>
        @*@if (SessionParameters.CurrentCongress.Configuration.CanUserSelectChairs && (bool)ViewBag.HasHall)
        {
            <div class="item-row">
                <div class="table-row-cap">
                    <div class="item" @(SessionParameters.CurrentCongress.Configuration.GetConfigurationContent().HallMapId.HasValue ? "style=cursor:pointer onclick=ShowHallImage('" + SessionParameters.CurrentCongress.Configuration.GetConfigurationContent().HallMapId + "')" : "")>
                        @Resources.Reservation.Hall @(SessionParameters.CurrentCongress.Configuration.GetConfigurationContent().HallMapId.HasValue ? "(" + Resources.Congress.ViewHallMap + ")" : "")
                    </div>
                </div>
                <div class="table-row-item">
                    <div class="item">
                        @Html.DropDownList("HallId", (SelectList)ViewBag.CongressHalls, "", new { style = "width: 120px" })
                        <input type="button" onclick="ShowHall()" value="@Resources.Congress.SelectChair" style="width: 100px" />
                    </div>
                </div>
            </div>
        }*@

        <div id="DivDiscount" class="fit">
        </div>
    </div>
